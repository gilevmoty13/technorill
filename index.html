<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TechnoRill ‚Äî –ë–ª–æ–≥ –æ —Ç–µ—Ö–Ω–∏–∫–µ</title>
  <link rel="icon" href="logo1.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body { margin:0; font-family:Arial,sans-serif; color:#ccc; background:#000 url('logo.png') center/contain no-repeat fixed; }
    header { background:rgba(0,0,0,.7); text-align:center; padding:40px 20px; }
    header img { width:120px; height:auto; border-radius:50%; }
    h1 { margin-top:20px; font-size:2.5rem; color:#00cc66; }
    .content { max-width:800px; margin:40px auto; background:rgba(0,0,0,.75); padding:30px; border-radius:15px; }
    .post { margin-bottom:30px; }
    h2 { color:#eee; }
    footer { background:rgba(0,0,0,.7); text-align:center; padding:20px; color:#888; }
    a { color:#00cc66; cursor:pointer; text-decoration:none; border-bottom:1px dashed #00cc66; }
    a:hover { color:#00ff80; border-bottom:1px solid #00ff80; }
    .notification { position:fixed; top:20px; right:20px; background:rgba(0,200,100,.9); color:#fff; padding:10px 20px; border-radius:5px; display:none; z-index:1000; }

    .tabs { display:flex; justify-content:center; margin-bottom:30px; border-bottom:1px solid #333; }
    .tab { padding:10px 20px; cursor:pointer; color:#888; border-bottom:3px solid transparent; transition:all .3s; }
    .tab.active { color:#00cc66; border-bottom:3px solid #00cc66; }
    .tab:hover { color:#00ff80; }
    .tab-content { display:none; } .tab-content.active { display:block; }

    .news-item { background:rgba(30,30,30,.5); padding:15px; margin-bottom:20px; border-radius:8px; border-left:3px solid #00cc66; }
    .news-date { color:#888; font-size:.9em; margin-bottom:5px; }
    .social-links { display:flex; flex-direction:column; gap:15px; margin-top:20px; }
    .social-link { display:flex; align-items:center; padding:10px 15px; background:rgba(50,50,50,.5); border-radius:8px; transition:all .3s; text-decoration:none; border:1px solid transparent; }
    .social-link:hover { background:rgba(70,70,70,.7); border-color:#00cc66; transform:translateY(-2px); }
    .social-icon { font-size:24px; margin-right:15px; width:30px; text-align:center; }
    .tiktok-icon { color:#fff; } .youtube-icon{ color:#f00; } .instagram-icon{ color:#E4405F; }

    #contacts .post { text-align:center; display:flex; flex-direction:column; align-items:center; }
    #contacts .social-links { width:100%; max-width:400px; margin:0 auto; }
    #contacts .social-link { justify-content:center; text-align:left; }

    /* –ü–∞–Ω–µ–ª—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ / —É–¥–∞–ª–µ–Ω–∏—è */
    #publishPanel{
      box-sizing:border-box; width:min(560px,96vw);
      right:12px; bottom:12px; max-height:90vh; overflow:auto;
      position:fixed; background:rgba(0,0,0,.92); border:1px solid #00cc66;
      border-radius:12px; padding:16px; z-index:1199; display:none;
      backdrop-filter: blur(3px);
    }
    #publishPanel label{ display:block; margin:8px 0 6px; }
    #publishPanel textarea{ width:100%; min-height:160px; resize:vertical; }
    #publishPanel input, #publishPanel textarea, #publishPanel button{ box-sizing:border-box; }
    #publishPanel input, #publishPanel textarea{
      width:100%; padding:10px; border-radius:10px; border:1px solid #333; background:#000; color:#eee; min-width:0; word-break:break-word;
    }
    #publishPanel .two-col{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    #publishPanel .two-col > div{ min-width:0; }
    #publishPanel .btn{ border:1px solid #00cc66; background:#002d1f; color:#00ff80; border-radius:10px; padding:10px 14px; cursor:pointer; }
    #publishPanel .btn-ghost{ border-color:#444; background:#111; color:#bbb; }
    #publishPanel .hr{ height:1px; background:#1f3b2d; margin:16px 0; border:0; }
    .muted{ color:#9fe6c3; font-size:.9em; }
    .row{ display:flex; gap:10px; align-items:center; justify-content:space-between; }
    .row .btn{ flex:0 0 auto; }
    .row .grow{ flex:1 1 auto; }

    @media (max-width:560px){
      #publishPanel{ left:8px; right:8px; top:8px; bottom:8px; width:auto; max-height:calc(100vh - 16px);}
      #publishPanel .two-col{ grid-template-columns:1fr; }
    }

    /* --- Admin login modal --- */
    #adminModal{
      display:none; position:fixed; inset:0; background:rgba(0,0,0,.6);
      z-index:1200; align-items:center; justify-content:center; padding:12px;
    }
    #adminModal .modal-card{
      background:#111; border:1px solid #00cc66; border-radius:12px;
      width:min(520px,92vw); max-height:92vh; overflow:auto; padding:20px; box-sizing:border-box; margin:0 auto;
    }
    #adminModal h3{ color:#00ff80; margin:0 0 10px; }
    #adminModal label{ display:block; margin:10px 0 6px; }
    #adminModal input{
      width:100%; padding:10px; border-radius:8px; border:1px solid #333;
      background:#000; color:#eee; box-sizing:border-box;
    }
    #adminModal .btn-row{ display:flex; gap:10px; margin-top:14px; }
    #adminModal .btn{ padding:8px 14px; border-radius:8px; cursor:pointer; }
    #adminModal .btn-primary{ border:1px solid #00cc66; background:#002d1f; color:#00ff80; }
    #adminModal .btn-ghost{ border:1px solid #444; background:#222; color:#bbb; }
    #adminErr{ color:#ff6b6b; display:none; margin-top:10px; }
  </style>
</head>
<body>
  <div class="notification" id="notification">–ü–æ—á—Ç–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!</div>

  <header>
    <img src="logo1.png" alt="TechnoRill Logo">
    <h1>TechnoRill</h1>
    <p>–ë–ª–æ–≥ –æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö</p>
  </header>

  <div class="content">
    <div class="tabs">
      <div class="tab active" data-tab="main">–ì–ª–∞–≤–Ω–∞—è</div>
      <div class="tab" data-tab="fresh-news">–°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö</div>
      <div class="tab" data-tab="news">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</div>
      <div class="tab" data-tab="contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
    </div>

    <div id="main" class="tab-content active">
      <div class="post">
        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
        <p>–ö–∞–Ω–∞–ª TechnoRill —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ —Ç–µ—Ö–Ω–∏–∫–µ –∏ –≥–∞–¥–∂–µ—Ç–∞—Ö!</p>
      </div>
    </div>

    <div id="fresh-news" class="tab-content">
      <div class="post">
        <h1>–°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö</h1>
        <p>–ó–¥–µ—Å—å –ø—É–±–ª–∏–∫—É—é—Ç—Å—è —Å–∞–º—ã–µ –Ω–æ–≤—ã–µ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ –º–∏—Ä–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π üöÄ</p>
      </div>
    </div>

    <div id="news" class="tab-content">
      <div class="post">
        <h1>–í–∏–¥–µ–æ –∑–∞ –º–µ—Å—è—Ü</h1>
        <!-- NEWS-START -->
<div class="news-item" data-id="50e63c35de06b165">
  <div class="news-date">28</div>
  <h3>–∫–µ–∫</h3>
  <p>–µ–∫–µ</p>
  <div class="social-links">
    <a href="–∫–µ–∫"  target="_blank" class="social-link"><i class="fab fa-tiktok social-icon tiktok-icon"></i><div><div class="social-text">TikTok</div></div></a>
    <a href="–µ–∫" target="_blank" class="social-link"><i class="fab fa-youtube social-icon youtube-icon"></i><div><div class="social-text">YouTube</div></div></a>
    <a href="–µ–∫–µ"   target="_blank" class="social-link"><i class="fab fa-instagram social-icon instagram-icon"></i><div><div class="social-text">Instagram*</div></div></a>
  </div>
</div>

        <div class="news-item">
          <div class="news-date">27 —Å–µ–Ω—Ç—è–±—Ä—è 2025</div>
          <h3>–û—á–∏—â–∞—Ç—å –ø–∞–º—è—Ç—å –Ω–∞ iPhone —Å—Ç–∞–ª–æ –ª–µ–≥—á–µ?</h3>
          <p>–í —ç—Ç–æ–º –≤–∏–¥–µ–æ —Ç—ã —É–∑–Ω–∞–µ—à—å –æ–± –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è iPhone!</p>
          <div class="social-links">
            <a href="https://www.tiktok.com/@technorill/video/7553701581309480214" target="_blank" class="social-link">
              <i class="fab fa-tiktok social-icon tiktok-icon"></i><div><div class="social-text">TikTok</div></div>
            </a>
            <a href="https://youtube.com/shorts/Yrtjg5RFcFE" target="_blank" class="social-link">
              <i class="fab fa-youtube social-icon youtube-icon"></i><div><div class="social-text">YouTube</div></div>
            </a>
            <a href="https://www.instagram.com/reel/DO_prhlDivv" target="_blank" class="social-link">
              <i class="fab fa-instagram social-icon instagram-icon"></i><div><div class="social-text">Instagram*</div></div>
            </a>
          </div>
        </div>
        <!-- NEWS-END -->
      </div>
    </div>

    <div id="contacts" class="tab-content">
      <div class="post">
        <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
        <p>–ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ö–∏—Ä–∏–ª–ª –∏ —è –≤–µ–¥—É—â–∏–π –¥–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞.</p>
        <p><strong>–ü–æ—á—Ç–∞ –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:</strong> 
          <span id="email" style="color:#00cc66; cursor:pointer; border-bottom:1px dashed #00cc66;">garkovivan8430@gmail.com</span>
          <span style="margin-left:5px; font-size:.9em; color:#888;">(–∫–ª–∏–∫–Ω–∏—Ç–µ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å)</span>
        </p>
        <p><strong>–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –ø–∏—Å–∞—Ç—å:</strong> 
          <a href="https://t.me/kiril_podderzka_Not_Bot" target="_blank" class="telegram-link">t.me/kiril_podderzka_Not_Bot</a>
        </p>
      </div>
    </div>
  </div>

  <footer>
    ¬© 2025 –ö–∏—Ä–∏–ª–ª.
    <p style="margin-top:10px; font-size:.8em;">*–∫–æ–º–ø–∞–Ω–∏—è Meta –ø—Ä–∏–∑–Ω–∞–Ω–∞ —ç–∫—Å—Ç—Ä–µ–º–∏—Å—Ç—Å–∫–æ–π –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–æ—Å—Å–∏–∏</p>
  </footer>

  <!-- –ú–æ–¥–∞–ª –ª–æ–≥–∏–Ω–∞ -->
  <div id="adminModal">
    <div class="modal-card">
      <h3>–í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
      <label>–õ–æ–≥–∏–Ω</label>
      <input id="adminLogin" type="text" placeholder="–õ–æ–≥–∏–Ω">
      <label>–ü–∞—Ä–æ–ª—å</label>
      <input id="adminPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
      <div class="btn-row">
        <button id="adminLoginBtn" class="btn btn-primary">–í–æ–π—Ç–∏</button>
        <button id="adminCancelBtn" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
      </div>
      <p id="adminErr">–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</p>
    </div>
  </div>

  <!-- –ü–∞–Ω–µ–ª—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ + —É–¥–∞–ª–µ–Ω–∏—è -->
  <div id="publishPanel">
    <div class="row" style="margin-bottom:8px;">
      <strong style="color:#00ff80;">–ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–æ–≤–æ—Å—Ç–∏</strong>
      <button id="closePublish" title="–°–≤–µ—Ä–Ω—É—Ç—å" class="btn-ghost btn">√ó</button>
    </div>

    <label>–î–∞—Ç–∞ (—Ç–µ–∫—Å—Ç):</label>
    <input id="fDate" type="text" placeholder="27 —Å–µ–Ω—Ç—è–±—Ä—è 2025">

    <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫:</label>
    <input id="fTitle" type="text" placeholder="–í—ã—à–ª–æ –Ω–æ–≤–æ–µ –≤–∏–¥–µ–æ!">

    <label>–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
    <input id="fDesc" type="text" placeholder="–ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ">

    <div class="two-col">
      <div>
        <label>TikTok —Å—Å—ã–ª–∫–∞:</label>
        <input id="fTikTok" type="url" placeholder="https://www.tiktok.com/...">
      </div>
      <div>
        <label>YouTube —Å—Å—ã–ª–∫–∞:</label>
        <input id="fYouTube" type="url" placeholder="https://youtube.com/...">
      </div>
      <div>
        <label>Instagram —Å—Å—ã–ª–∫–∞:</label>
        <input id="fInsta" type="url" placeholder="https://www.instagram.com/reel/...">
      </div>
    </div>

    <button id="publishBtn" class="btn" style="width:100%; margin-top:12px;">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>

    <div id="exportWrap" style="display:none; margin-top:12px;">
      <p class="muted">–°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç HTML –∏ –≤—Å—Ç–∞–≤—å –≤ –∫–æ–¥ (–µ—Å–ª–∏ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ):</p>
      <textarea id="exportHtml" rows="8"></textarea>
      <button id="copyExport" class="btn" style="margin-top:8px;">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>

    <hr class="hr">

    <strong style="color:#00ff80;">–£–¥–∞–ª–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</strong>
    <p class="muted">–ù–∞–¥—ë–∂–Ω–µ–µ –≤—Å–µ–≥–æ —É–¥–∞–ª—è—Ç—å –ø–æ <b>ID</b> (–æ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–∞–∫ <code>data-id</code>). –ï—Å–ª–∏ ID –Ω–µ—Ç ‚Äî —É–∫–∞–∂–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏/–∏–ª–∏ –¥–∞—Ç—É.</p>

    <label>ID –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:</label>
    <input id="delId" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: a1b2c3d4e5f6a7b8">

    <div class="two-col">
      <div>
        <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ (–¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ ID):</label>
        <input id="delTitle" type="text" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏">
      </div>
      <div>
        <label>–î–∞—Ç–∞ (–¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ ID):</label>
        <input id="delDate" type="text" placeholder="27 —Å–µ–Ω—Ç—è–±—Ä—è 2025">
      </div>
    </div>

    <div class="row" style="margin-top:12px;">
      <button id="deleteBtn" class="btn">–£–¥–∞–ª–∏—Ç—å</button>
      <button id="hideAllIds" class="btn-ghost btn">–ü–æ–∫–∞–∑–∞—Ç—å ID –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</button>
    </div>
  </div>

  <!-- –ë–∞–∑–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const emailElement = document.getElementById('email');
      const notification = document.getElementById('notification');
      if (emailElement) {
        emailElement.addEventListener('click', function() {
          const tempInput = document.createElement('input');
          tempInput.value = 'garkovivan8430@gmail.com';
          document.body.appendChild(tempInput);
          tempInput.select(); tempInput.setSelectionRange(0, 99999);
          try { document.execCommand('copy'); notification.style.display='block'; setTimeout(()=>notification.style.display='none',2000); }
          catch { navigator.clipboard.writeText('garkovivan8430@gmail.com').then(()=>{ notification.style.display='block'; setTimeout(()=>notification.style.display='none',2000);}); }
          document.body.removeChild(tempInput);
        });
      }
      document.querySelectorAll('.tab').forEach(tab=>{
        tab.addEventListener('click', ()=>{
          const target = tab.getAttribute('data-tab');
          document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
          tab.classList.add('active'); document.getElementById(target).classList.add('active');
        });
      });
    });
  </script>

  <!-- –ê–¥–º–∏–Ω-–ª–æ–≥–∏–∫–∞ (–≤—Ö–æ–¥ + –ø—É–±–ª–∏–∫–∞—Ü–∏—è + —É–¥–∞–ª–µ–Ω–∏–µ) -->
  <script>
  (function() {
    const WORKER_BASE = 'https://falling-term-2b37.garkovkirill.workers.dev';
    const ADMIN_KEY = '30Mu30Fasa';

    const SALT = 'trill#2025'; // –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–≥–∏–Ω–∞
    const HASH_LOGIN = '01001e8a19aa584d87efe4ebbd09ec191267921d39e1f845a4ac932916de1323';
    const HASH_PASS  = '7491d3a47818924589874ef588685df9e0f2e2fd21122f34a4a427b7d9360d46';

    async function sha256Hex(str){ const data=new TextEncoder().encode(SALT+str); const buf=await crypto.subtle.digest('SHA-256',data); return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join(''); }

    // === client-side ID (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –≤–æ—Ä–∫–µ—Ä–æ–º) ===
    const enc = new TextEncoder();
    const lower = s => (s??'').toString().replace(/\s+/g,' ').trim().toLowerCase();
    async function makeId(title, date){
      const buf = await crypto.subtle.digest('SHA-256', enc.encode(lower(title)+'|'+lower(date)));
      const hex = Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
      return hex.slice(0,16);
    }

    const adminModal = document.getElementById('adminModal');
    const adminLoginBtn = document.getElementById('adminLoginBtn');
    const adminCancelBtn= document.getElementById('adminCancelBtn');
    const adminErr = document.getElementById('adminErr');
    const loginInput = document.getElementById('adminLogin');
    const passInput  = document.getElementById('adminPass');

    const PUBLISH_PANEL = document.getElementById('publishPanel');
    const closePublish  = document.getElementById('closePublish');

    const fDate   = document.getElementById('fDate');
    const fTitle  = document.getElementById('fTitle');
    const fDesc   = document.getElementById('fDesc');
    const fTikTok = document.getElementById('fTikTok');
    const fYouTube= document.getElementById('fYouTube');
    const fInsta  = document.getElementById('fInsta');

    const publishBtn = document.getElementById('publishBtn');
    const exportWrap = document.getElementById('exportWrap');
    const exportHtml = document.getElementById('exportHtml');
    const copyExport = document.getElementById('copyExport');

    const delId    = document.getElementById('delId');
    const delTitle = document.getElementById('delTitle');
    const delDate  = document.getElementById('delDate');
    const deleteBtn= document.getElementById('deleteBtn');
    const hideAllIdsBtn = document.getElementById('hideAllIds');

    function openLoginModal(){
      if (adminModal.style.display === 'flex') return;
      adminErr.style.display='none'; loginInput.value=''; passInput.value='';
      adminModal.style.display='flex'; setTimeout(()=>loginInput.focus(),0);
    }

    // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏: Ctrl/Cmd+A ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –ª–æ–≥–∏–Ω; Esc ‚Äî –∑–∞–∫—Ä—ã—Ç—å
    document.addEventListener('keydown',(e)=>{
      const isCtrl=(e.ctrlKey||e.metaKey); const key=e.key.toLowerCase();
      if(isCtrl && key==='a'){ e.preventDefault(); openLoginModal(); }
      if(key==='escape'){ if(adminModal.style.display==='flex') adminModal.style.display='none'; if(PUBLISH_PANEL.style.display==='block') PUBLISH_PANEL.style.display='none'; }
    });
    adminCancelBtn.addEventListener('click', ()=> adminModal.style.display='none');
    adminModal.addEventListener('click', (e)=>{ if(e.target===adminModal) adminModal.style.display='none'; });

    async function tryLogin(){
      try {
        const okLogin=(await sha256Hex(loginInput.value.trim()))===HASH_LOGIN;
        const okPass =(await sha256Hex(passInput.value))===HASH_PASS;
        if(okLogin&&okPass){ adminErr.style.display='none'; adminModal.style.display='none'; PUBLISH_PANEL.style.display='block'; PUBLISH_PANEL.scrollTop=0; }
        else adminErr.style.display='block';
      } catch (e) { console.error('Login error:', e); adminErr.style.display='block'; }
    }
    adminLoginBtn.addEventListener('click', tryLogin);
    passInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') tryLogin(); });
    closePublish.addEventListener('click', ()=> PUBLISH_PANEL.style.display='none');

    // === –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ HTML –∫–∞—Ä—Ç–æ—á–∫–∏ ===
    function buildNewsHTML(data, id){
      const esc=(s)=>(s??'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
      const link=(href, icon, txt, cls)=> href?`<a href="${href}" target="_blank" class="social-link"><i class="${icon} social-icon ${cls||''}"></i><div><div class="social-text">${txt}</div></div></a>`:'';
      return `
<div class="news-item" data-id="${id}">
  <div class="news-date">${esc(data.date)}</div>
  <h3>${esc(data.title)}</h3>
  ${data.desc?`<p>${esc(data.desc)}</p>`:''}
  <div class="social-links">
    ${link(data.tiktok,'fab fa-tiktok','TikTok','tiktok-icon')}
    ${link(data.youtube,'fab fa-youtube','YouTube','youtube-icon')}
    ${link(data.insta,'fab fa-instagram','Instagram*','instagram-icon')}
  </div>
</div>`.trim();
    }

    function getNewsContainer(){ return document.querySelector('#news .post') || document.getElementById('news'); }

    // === –ø—É–±–ª–∏–∫–∞—Ü–∏—è ===
    publishBtn.addEventListener('click', async ()=>{
      const data={
        date: fDate.value.trim() || new Date().toLocaleDateString('ru-RU',{day:'2-digit',month:'long',year:'numeric'}),
        title: fTitle.value.trim(),
        desc: fDesc.value.trim(),
        tiktok: fTikTok.value.trim(),
        youtube: fYouTube.value.trim(),
        insta: fInsta.value.trim()
      };
      if(!data.title){ alert('–£–∫–∞–∂–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫.'); return; }
      if(!data.tiktok && !data.youtube && !data.insta){ alert('–î–æ–±–∞–≤—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Å—Å—ã–ª–∫—É.'); return; }

      const id = await makeId(data.title, data.date);
      const html=buildNewsHTML(data, id);
      const container=getNewsContainer();
      if(container){
        container.innerHTML = container.innerHTML.replace('<!-- NEWS-START -->', `<!-- NEWS-START -->\n${html}\n`);
      }

      exportWrap.style.display='block';
      exportHtml.value=html;

      if(/^https?:\/\//.test(WORKER_BASE)){
        fetch(WORKER_BASE + '/publish', {
          method:'POST',
          headers:{
            'Content-Type':'application/json',
            'x-admin-key': ADMIN_KEY
          },
          body: JSON.stringify(data)
        })
        .then(async (r)=>{
          const text = await r.text();
          let json; try{ json = JSON.parse(text);}catch(_){}
          if (!r.ok || !json?.ok){
            console.error('Worker publish error:', {status:r.status, text});
            alert('–û—à–∏–±–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ ('+r.status+'): \n' + text);
            return;
          }
          console.log('Publish OK:', json);
          alert('–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ GitHub.');
        })
        .catch((err)=>{
          console.error('Network/JS error:', err);
          alert('–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞: ' + (err?.message || err));
        });
      } else {
        alert('WORKER_BASE –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω ‚Äî –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–¥ –Ω–∏–∂–µ –¥–ª—è —Ä—É—á–Ω–æ–π –≤—Å—Ç–∞–≤–∫–∏.');
      }
    });

    copyExport.addEventListener('click', ()=>{ exportHtml.select(); document.execCommand('copy'); });

    // === —É—Ç–∏–ª–∏—Ç–∞: –ø–æ–∫–∞–∑–∞—Ç—å ID –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ===
    let idsShown = false;
    hideAllIdsBtn.addEventListener('click', ()=>{
      idsShown = !idsShown;
      document.querySelectorAll('.news-item').forEach(item=>{
        let badge = item.querySelector('.__id');
        if(idsShown){
          if(!badge){
            badge = document.createElement('div');
            badge.className='__id';
            badge.style.fontSize='12px';
            badge.style.color='#9fe6c3';
            badge.style.marginTop='6px';
            badge.textContent = 'ID: ' + (item.getAttribute('data-id')||'‚Äî');
            const tgt = item.querySelector('h3') || item.firstElementChild;
            (tgt?tgt:item).appendChild(badge);
          } else {
            badge.textContent = 'ID: ' + (item.getAttribute('data-id')||'‚Äî');
          }
        } else {
          if(badge) badge.remove();
        }
      });
      hideAllIdsBtn.textContent = idsShown ? '–°–∫—Ä—ã—Ç—å ID –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ' : '–ü–æ–∫–∞–∑–∞—Ç—å ID –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ';
    });

    // === —É–¥–∞–ª–µ–Ω–∏–µ: –ª–æ–∫–∞–ª—å–Ω–æ + —á–µ—Ä–µ–∑ –≤–æ—Ä–∫–µ—Ä ===
    function removeDomById(id){
      const el = document.querySelector(`.news-item[data-id="${id}"]`);
      if(el){ el.remove(); return true; }
      return false;
    }
    function softRemoveByTitleDate(title, date){
      const t = lower(title||''); const d = lower(date||'');
      const items = document.querySelectorAll('.news-item');
      for(const item of items){
        const ht = (item.querySelector('h3')?.textContent||'').toLowerCase().trim();
        const hd = (item.querySelector('.news-date')?.textContent||'').toLowerCase().trim();
        const okT = t ? ht === t : true;
        const okD = d ? hd === d : true;
        if(okT && okD){ item.remove(); return true; }
      }
      return false;
    }

    deleteBtn.addEventListener('click', async ()=>{
      let id = delId.value.trim();
      const title = delTitle.value.trim();
      const date  = delDate.value.trim();

      if(!id){
        if(!title && !date){ alert('–£–∫–∞–∂–∏ ID –∏–ª–∏ –ó–∞–≥–æ–ª–æ–≤–æ–∫/–î–∞—Ç—É –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.'); return; }
        id = await makeId(title||'', date||'');
      }

      // 1) –ª–æ–∫–∞–ª—å–Ω–æ —Å—Ä–∞–∑—É —Å–∫—Ä—ã–≤–∞–µ–º (–ø–æ id, –∏–Ω–∞—á–µ –ø–æ title/date)
      let removed = removeDomById(id);
      if(!removed && (title || date)) removed = softRemoveByTitleDate(title, date);
      if(!removed){
        alert('–õ–æ–∫–∞–ª—å–Ω–æ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å ID/–∑–∞–≥–æ–ª–æ–≤–æ–∫/–¥–∞—Ç—É.');
      }

      // 2) —Å–µ—Ä–≤–µ—Ä
      const payload = id ? { id } : { title, date };
      fetch(WORKER_BASE + '/delete', {
        method:'POST',
        headers:{
          'Content-Type':'application/json',
          'x-admin-key': ADMIN_KEY
        },
        body: JSON.stringify(payload)
      })
      .then(async (r)=>{
        const text = await r.text();
        let json; try{ json = JSON.parse(text);}catch(_){}
        if(!r.ok || !json?.ok){
          console.error('Worker delete error:', {status:r.status, text});
          alert('–£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —É–¥–∞–ª–æ—Å—å ('+r.status+'). –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–∫—Ä—ã—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –≤–µ—Ä–Ω—ë—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –µ—Å–ª–∏ –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é/—á–µ—Ä–µ–∑ –≤–æ—Ä–∫–µ—Ä.\n\n'+text);
          return;
        }
        alert('–£–¥–∞–ª–µ–Ω–æ –∏–∑ GitHub.');
      })
      .catch(err=>{
        console.error('Network/JS error:', err);
        alert('–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: ' + (err?.message || err));
      });
    });

  })();
  </script>
</body>
</html>
